<div class="page">
  <div class="card">

    <h2 class="title">Cadastro de Empresas</h2>

    <form class="form" [formGroup]="form">

    
      <div class="form-group">
        <label>*Nome da empresa</label>
        <input type="text" formControlName="name" placeholder="Enter company name">

        <div class="error" *ngIf="form.get('name')?.touched && form.get('name')?.invalid">
          Nome da empresa é obrigatório.
        </div>
      </div>

    
      <div class="form-group">
        <label>*CNPJ</label>
        <input type="text" formControlName="cnpj" placeholder="00000000000000">
      
     
        <div class="error" *ngIf="form.get('cnpj')?.touched && form.get('cnpj')?.hasError('required')">
          CNPJ é obrigatório.
        </div>
      
    
        <div class="error" *ngIf="form.get('cnpj')?.touched && form.get('cnpj')?.hasError('invalidLength')">
          O CNPJ deve ter exatamente 14 dígitos.
        </div>
      
        
        <div class="error" *ngIf="form.get('cnpj')?.hasError('exists')">
          Este CNPJ já existe.
        </div>
      </div> 


      <div class="form-group">
        <label>*Endereço</label>
        <input type="text" formControlName="address" placeholder="Enter address">

        <div class="error" *ngIf="form.get('address')?.touched && form.get('address')?.invalid">
          Endereço é obrigatório.
        </div>
      </div>

     
      <div class="form-group">
        <h3>Vincular Funcionários</h3>

        <ng-container *ngIf="employees.length > 0; else noEmployees">

          <div *ngFor="let emp of employees">
            <label>
              <input 
                type="checkbox"
                [value]="emp.id"
                (change)="toggleEmployee(emp.id, $event)"
                [checked]="selectedEmployees.includes(emp.id)"
              />
              {{ emp.name }} ({{ emp.login }})
            </label>
          </div>

        </ng-container>

        <ng-template #noEmployees>
          Sem funcionários cadastrados.
        </ng-template>

      </div>

      <div class="actions">
        <button type="button" class="btn primary" (click)="save()" [disabled]="loading">
          {{ loading ? 'Saving...' : 'Save' }}
        </button>

        <button type="button" class="btn" (click)="cancel()">Cancel</button>
      </div>

    </form>

  </div>
</div>
